<div class="dashboard-container">
  <!-- Navbar -->
  <nav class="navbar">
    <div class="navbar-content">
      <h2 class="logo">ğŸ“… Event Planner</h2>
      <div class="nav-actions">
        <span class="user-email">{{ userEmail() }}</span>
        <button class="btn-logout" (click)="logout()">Logout</button>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="dashboard-content">
    <!-- Header -->
    <div class="dashboard-header">
      <h1>Events Dashboard</h1>
      <button class="btn-create" (click)="createEvent()">
        <span>â• Create Event</span>
      </button>
    </div>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab" [class.active]="activeTab() === 'all'" (click)="switchTab('all')">
        All Events
      </button>
      <button class="tab" [class.active]="activeTab() === 'invitations'" (click)="switchTab('invitations')">
        My Invitations
      </button>
    </div>

    <!-- Filters (only for All Events tab) -->
    @if (activeTab() === 'all') {
    <div class="filters-section">
      <div class="filters">
        <input type="text" class="filter-input" placeholder="Search events..." [(ngModel)]="searchQuery"
          (keyup.enter)="applyFilters()">

        <input type="date" class="filter-input" placeholder="From Date" [(ngModel)]="dateFrom">

        <input type="date" class="filter-input" placeholder="To Date" [(ngModel)]="dateTo">

        <button class="btn-filter" (click)="applyFilters()">Search</button>
        <button class="btn-clear" (click)="clearFilters(); loadEvents()">Clear</button>
      </div>
    </div>
    }

    <!-- Loading -->
    @if (isLoading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Loading events...</p>
    </div>
    }

    <!-- Error Message -->
    @if (errorMessage()) {
    <div class="error-banner">
      {{ errorMessage() }}
    </div>
    }

    <!-- Events Grid -->
    @if (!isLoading() && !errorMessage()) {
    @if (filteredEvents().length > 0) {
    <div class="events-grid">
      @for (event of filteredEvents(); track event.id) {
      <div class="event-card" (click)="viewEvent(event.id!)">
        <div class="event-header">
          <h3>{{ event.title }}</h3>
          @if (event.user_role) {
          <span class="badge" [ngClass]="getRoleBadgeClass(event.user_role)">
            {{ event.user_role }}
          </span>
          }
        </div>

        <p class="event-description">{{ event.description || 'No description' }}</p>

        <div class="event-details">
          <div class="detail-item">
            <span class="icon">ğŸ“…</span>
            <span>{{ event.date }}</span>
          </div>
          <div class="detail-item">
            <span class="icon">ğŸ•</span>
            <span>{{ event.time }}</span>
          </div>
          <div class="detail-item">
            <span class="icon">ğŸ“</span>
            <span>{{ event.location }}</span>
          </div>
        </div>

        @if (event.user_status) {
        <div class="event-status">
          <span class="badge" [ngClass]="getStatusBadgeClass(event.user_status)">
            {{ event.user_status === 'not_going' ? 'Not Going' :
            event.user_status === 'maybe' ? 'Maybe' :
            event.user_status.charAt(0).toUpperCase() + event.user_status.slice(1) }}
          </span>
        </div>
        }

        <div class="event-footer">
          <span class="attendee-count">
            ğŸ‘¥ {{ event.attendees?.length || 0 }} attendees
          </span>
          <span class="organizer">by {{ event.organizer_email }}</span>
        </div>
      </div>
      }
    </div>
    } @else {
    <div class="empty-state">
      <div class="empty-icon">ğŸ“­</div>
      <h3>No events found</h3>
      <p>
        @if (activeTab() === 'all') {
        Create your first event to get started!
        } @else {
        You have no pending invitations
        }
      </p>
    </div>
    }
    }
  </div>
</div>